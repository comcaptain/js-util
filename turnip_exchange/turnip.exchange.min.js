const PRICE_SELECTOR="p.ml-2",QUEUE_STATUS_SELECTOR="p.mr-1",TEXT_SELECTOR="p.text-xs.p-4",ISLAND_SELECTOR="div.note",PRICE_NAME="price",QUEUE_SIZE_NAME="queue-size";function extractInfo(e){let t=parseInt(e.querySelector(PRICE_SELECTOR).textContent.replace(" Bells","")),n=e.querySelector(QUEUE_STATUS_SELECTOR).textContent.trim(),o=parseInt(n.match(/^Waiting: (\d+)\/\d+/)[1]),i=e.querySelector(TEXT_SELECTOR).textContent;return{node:e,price:t,text:i,queueSize:o}}function process(){let e=[].slice.apply(document.querySelectorAll(ISLAND_SELECTOR));if(0===e.length)return;console.info(`Found ${e.length} islands`);let t=e.map(extractInfo),n=e[0].parentNode;e.forEach(e=>n.removeChild(e)),t.sort((e,t)=>t.price-e.price).forEach(e=>n.appendChild(e.node));let o=parseInt(document.querySelector(`[name=${PRICE_NAME}]:checked`).value),i=parseInt(document.querySelector(`[name=${QUEUE_SIZE_NAME}]:checked`).value),a=!1;for(let e of t)e.price<o||e.queueSize>i||e.text.toLowerCase().includes("nmt")||e.text.toLowerCase().includes("99k")||e.text.toLowerCase().includes("stacks of turnip")?e.node.style.display="none":(e.node.style.display=null,a=!0);if(!a){let e=3+parseInt(5*Math.random());console.info("island not found, going to refresh within "+e+" seconds"),setTimeout(()=>location.reload(),1e3*e)}}function createCheckBox(e,t,n,o){void 0===o&&(o="");let i=n?"checked":"",a=document.createElement("span");return a.innerHTML=`<input class="my-checkbox" type="radio" ${i} name="${e}" id="${e}-${t}" value="${t}">\n\t\t<label class="for-my-checkbox" for="${e}-${t}">\n\t\t\t<span data-hover="${t}${o}">${t}${o}</span>\n\t\t</label>`,a}function drawGUI(){let e=document.createElement("div");e.id="tony-exchange",e.appendChild(createCheckBox(PRICE_NAME,"400",!1,"$")),e.appendChild(createCheckBox(PRICE_NAME,"500",!1,"$")),e.appendChild(createCheckBox(PRICE_NAME,"600",!0,"$")),e.appendChild(createCheckBox(QUEUE_SIZE_NAME,"5",!0)),e.appendChild(createCheckBox(QUEUE_SIZE_NAME,"10")),e.appendChild(createCheckBox(QUEUE_SIZE_NAME,"20")),document.body.appendChild(e)}function bindListeners(){document.querySelector("#tony-exchange").addEventListener("change",e=>{"radio"===e.target.getAttribute("type")&&process()})}function initialize(){drawGUI(),process(),bindListeners()}async function waitUntilLoaded(){if(window.location.href.endsWith("turnip.exchange/islands")){for(;;){let e=document.querySelectorAll(ISLAND_SELECTOR).length;if(console.info(`There are ${e} islands now`),e>0)break;await new Promise(e=>setTimeout(e,100))}initialize()}}window.onload=waitUntilLoaded;